# Numerical_simulation_of_viscous_incompressible_fluid_flows
Numerical simulation of viscous incompressible fluid flows.

Численное моделирование течений вязкой несжимаемой жидкости.

Рассмотрим двумерную коробку, имеющую фиксированный объем в пространстве. Это то, что мы называем контрольным объемом. 

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/472238de-9d4a-4576-9a26-5399e8050f34)

Сначала мы применим принцип сохранения массы к жидкости в контрольном объеме. Для несжимаемой жидкости (большинства жидкостей) это означает, что любая жидкость, попадающая в коробку, должна выйти из нее. Это называется уравнением непрерывности в механике жидкости.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/f381e569-1434-4f83-8703-0ad816ce6202)

Во-вторых, мы применим принцип сохранения импульса к управляющему объему. В конечном итоге это сводится к несжимаемым уравнениям Навье-Стокса.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/d3a05bf9-a5c1-4b49-a0f3-b02d1af68272)

Если мы сможем решить эти дифференциальные уравнения в частных производных (УЧП) одновременно после применения необходимых граничных условий, мы получим мгновенные скорости и давление в зависимости от времени, что позволит нам предсказать, как будет течь жидкость. 
Ниже приведен пример, который показывает, как преобразовать производные первого и второго порядка в их конечно-разностные приближения

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/0bd24c78-c63e-41c2-9d09-3047793653f3)

Мы начнем с создания классов для конкретных свойств задачи, начиная с граничного условия. УЧП решаются путем применения определенных граничных условий, которые указывают, как жидкость будет вести себя на границах области. Например, жидкость, текущая по трубе, будет иметь стенку с нулевой скоростью потока и вход, а также выход с некоторой заданной скоростью потока [2].
	Математически граничные условия могут быть выражены в двух формах — границах Дирихле и Неймана. Первый задает значение зависимой переменной на границе, тогда как второй задает значение производной зависимой переменной на границе.
	Поэтому мы создаем  класс Boundary, который обладает двумя свойствами — type и value.
	Затем область, ограниченная границей (например, внутренняя часть трубы), представляется с помощью 2D-сетки, и значения зависимых переменных вычисляются в центре ячеек сетки (для давления) или на гранях ячеек (для скоростей). Это называется подходом с распределенной сеткой. Чтобы представить сетку, мы создаем класс под названием Space. Метод CreateMesh создает матрицу заданного размера для зависимых переменных, а метод SetDeltas вычисляет значения дифференциальных длин на основе указанной длины и ширины области.
	Наконец, мы создаем класс Fluid для представления свойств жидкости, подобных плотности (rho) и вязкости (mu).
	Напишем функцию для реализации граничных условий для горизонтальной скорости (u), вертикальной скорости (v) и давления (p) на левой, правой, верхней и нижней границах 2D-области. Эта функция будет принимать объекты классов Space и Boundary и устанавливать граничные условия в соответствии с атрибутами этих объектов. Например, если граничный объект с типом Dirichlet и значением 0 передается в качестве объекта левой границы, функция установит это условие на левой границе.
	Прежде чем мы напишем конечно-разностные функции, нам нужно определить временной шаг для продвижения моделирования. Чтобы обеспечить сходимость методов конечных разностей, верхняя граница временного шага задается критерием Куранта-Фридрихса–Леви (CFL), который устанавливается в качестве временного шага для моделирования с использованием функции SetTimeStep. Соблюдение критерия CFL гарантирует, что информация, распространяемая с шагом по времени, не превышает расстояния между двумя элементами сетки
	Определив временной шаг, теперь мы готовы к реализации конечно-разностной схемы. Чтобы решить уравнение непрерывности и уравнения Навье-Стокса одновременно, мы используем схему предсказатель-корректор, включающую следующие шаги:


1)	Рассчитаем звездообразные скорости (u* и v*) по начальным скоростям без влияния давления.
	
   ![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/9ec59ed2-485a-495c-91a3-3e02d7e45805)
   
2)	Итеративно решаем уравнение Пуассона давления, используя звездообразные скорости.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/de225a02-7964-4a91-8832-1f45962e0e02)

3)	Рассчитываем скорости для следующего временного шага по давлению и звездообразным скоростям.

   ![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/84aac755-8581-485c-a274-867cdcdf2d34)


Определяем три различные функции для выполнения каждого из этих трех этапов.
	Наконец, мы определяем две функции для целей ввода—вывода - MakeResultDirectory для создания каталога с именем  “Result” для хранения текстовых файлов и writeToFile для сохранения значений переменных в текстовый файл каждые несколько итераций (задается с помощью аргумента interval).
	В качестве примера приведены входные данные, относящиеся к испытанию полости крышки (при числе Рейнольдса = 400). В этом тесте жидкость хранится в двумерном контейнере с тремя жесткими стенками, а четвертая стенка (или крышка) перемещается с одинаковой скоростью. 

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/c089aabd-eae8-4ab2-9cd5-a856b5879ab5)

Мы начинаем с указания входных переменных, описывающих область, а затем создаем объект Space с этими переменными. Далее задаются плотность и вязкость жидкости и создается объект класса Fluid. В-третьих, мы создаем граничные объекты для задания граничных условий скорости и давления. Наконец, задаются параметры моделирования и флаги, которые управляют временем моделирования, сохранением текстовых файлов и так далее. Теперь мы можем написать цикл для запуска моделирования. Общая процедура заключается в следующем. Пока время моделирования не закончится, алгоритм выполняет следующее на каждой итерации:
1)	Устанавливаем временной шаг в соответствии с критерием CFL.
2)	Устанавливаем граничные условия.
3)	Вычисляем звездообразные скорости.
4)	Решаем уравнение Пуассона давления, чтобы получить поле давления
5)	Определяем скорости на следующем временном шаге
6)	Записываем результаты в файл (если флаг файла равен 1)
7)	Увеличиваем время на величину, равную временному шагу
	Текстовые файлы, сгенерированные после запуска моделирования, содержат необработанные числа, которые сами по себе могут не давать физической картины потока жидкости. Однако простой анимированный контурный график можно использовать для объединения трех переменных — горизонтальной скорости, вертикальной скорости и давления — и интуитивно показать их эволюцию во времени. 
	Анимированный контур и график потока для контрольного значения полости крышки показаны ниже. На нем показано формирование вихря в центре по мере продвижения моделирования и, в конечном счете, переход к устойчивому состоянию.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/2c600a8b-1e36-4089-a5b5-e0607852a165)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/385287a9-afac-4889-9292-de565bd37640)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/418a783a-6a78-4bf0-b3da-b790435fc4c6)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/3ef5ec4b-185b-4bd8-a7bc-d08c8c15e8f4)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/064e9b2c-1932-4439-8a75-670a454896da)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/c92e52dc-bf78-41eb-b15a-ea0175078c19)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/af98d7f8-8c29-4225-8e12-c064c88f0b76)

Также проведено количественное сравнение статистики устойчивого потока с результатами Ghia et al. (1982). В частности, горизонтальные скорости вдоль вертикальной линии, проходящей через центр полости, и наоборот, сравниваются с результатами моделирования, приведенными в статье. Результаты показывают разумное согласие. Отклонения могут быть объяснены меньшей точностью конечно-разностной схемы и меньшим размером сетки.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/88b47579-afd2-4da8-816c-e01943e59d54)

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/00289568-c543-4ca4-ba3f-aafc19841b1c)
