# Numerical_simulation_of_viscous_incompressible_fluid_flows
Numerical simulation of viscous incompressible fluid flows.

Численное моделирование течений вязкой несжимаемой жидкости.

Рассмотрим двумерную коробку, имеющую фиксированный объем в пространстве. Это то, что мы называем контрольным объемом. 

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/472238de-9d4a-4576-9a26-5399e8050f34)

Сначала мы применим принцип сохранения массы к жидкости в контрольном объеме. Для несжимаемой жидкости (большинства жидкостей) это означает, что любая жидкость, попадающая в коробку, должна выйти из нее. Это называется уравнением непрерывности в механике жидкости.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/f381e569-1434-4f83-8703-0ad816ce6202)

Во-вторых, мы применим принцип сохранения импульса к управляющему объему. В конечном итоге это сводится к несжимаемым уравнениям Навье-Стокса.

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/d3a05bf9-a5c1-4b49-a0f3-b02d1af68272)

Если мы сможем решить эти дифференциальные уравнения в частных производных (УЧП) одновременно после применения необходимых граничных условий, мы получим мгновенные скорости и давление в зависимости от времени, что позволит нам предсказать, как будет течь жидкость. 
Ниже приведен пример, который показывает, как преобразовать производные первого и второго порядка в их конечно-разностные приближения

![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/0bd24c78-c63e-41c2-9d09-3047793653f3)

Мы начнем с создания классов для конкретных свойств задачи, начиная с граничного условия. УЧП решаются путем применения определенных граничных условий, которые указывают, как жидкость будет вести себя на границах области. Например, жидкость, текущая по трубе, будет иметь стенку с нулевой скоростью потока и вход, а также выход с некоторой заданной скоростью потока [2].
	Математически граничные условия могут быть выражены в двух формах — границах Дирихле и Неймана. Первый задает значение зависимой переменной на границе, тогда как второй задает значение производной зависимой переменной на границе.
	Поэтому мы создаем  класс Boundary, который обладает двумя свойствами — type и value.
	Затем область, ограниченная границей (например, внутренняя часть трубы), представляется с помощью 2D-сетки, и значения зависимых переменных вычисляются в центре ячеек сетки (для давления) или на гранях ячеек (для скоростей). Это называется подходом с распределенной сеткой. Чтобы представить сетку, мы создаем класс под названием Space. Метод CreateMesh создает матрицу заданного размера для зависимых переменных, а метод SetDeltas вычисляет значения дифференциальных длин на основе указанной длины и ширины области.
	Наконец, мы создаем класс Fluid для представления свойств жидкости, подобных плотности (rho) и вязкости (mu).
	Напишем функцию для реализации граничных условий для горизонтальной скорости (u), вертикальной скорости (v) и давления (p) на левой, правой, верхней и нижней границах 2D-области. Эта функция будет принимать объекты классов Space и Boundary и устанавливать граничные условия в соответствии с атрибутами этих объектов. Например, если граничный объект с типом Dirichlet и значением 0 передается в качестве объекта левой границы, функция установит это условие на левой границе.
	Прежде чем мы напишем конечно-разностные функции, нам нужно определить временной шаг для продвижения моделирования. Чтобы обеспечить сходимость методов конечных разностей, верхняя граница временного шага задается критерием Куранта-Фридрихса–Леви (CFL), который устанавливается в качестве временного шага для моделирования с использованием функции SetTimeStep. Соблюдение критерия CFL гарантирует, что информация, распространяемая с шагом по времени, не превышает расстояния между двумя элементами сетки
	Определив временной шаг, теперь мы готовы к реализации конечно-разностной схемы. Чтобы решить уравнение непрерывности и уравнения Навье-Стокса одновременно, мы используем схему предсказатель-корректор, включающую следующие шаги:


1)	Рассчитаем звездообразные скорости (u* и v*) по начальным скоростям без влияния давления.
2)	
   ![image](https://github.com/Sazerfai/Numerical_simulation_of_viscous_incompressible_fluid_flows/assets/79790554/9ec59ed2-485a-495c-91a3-3e02d7e45805)

   
